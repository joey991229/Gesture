<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>너 방금 뭐라고 했어? - Global Gesture Simulator</title>
    
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">

    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
      body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; font-family: 'Noto Sans KR', 'Inter', sans-serif; overflow: hidden; }
      #root { width: 100%; height: 100%; }
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
      .animate-float { animation: float 3s ease-in-out infinite; }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useMemo } = React;

      // --- 데이터 (생략 없이 사용자의 데이터를 그대로 포함) ---
      const CHARACTERS = [
        { id: "france", name: "Louis", country: "FRANCE", color: "bg-indigo-600", gradient: "from-indigo-600 to-blue-900", images: { default: "https://i.imgur.com/z1fnoyg.png", positive: "https://i.imgur.com/z1fnoyg.png", negative: "https://i.imgur.com/p5wHmwP.png" } },
        { id: "iran", name: "Reza", country: "IRAN", color: "bg-stone-600", gradient: "from-stone-600 to-stone-900", images: { default: "https://i.imgur.com/D9qVE53.png", positive: "https://i.imgur.com/D9qVE53.png", negative: "https://i.imgur.com/2Mot1Kx.png" } },
        { id: "japan", name: "Kenji", country: "JAPAN", color: "bg-rose-600", gradient: "from-rose-600 to-rose-900", images: { default: "https://i.imgur.com/kwgNZJN.png", positive: "https://i.imgur.com/kwgNZJN.png", negative: "https://i.imgur.com/kwgNZJN.png" } },
        { id: "usa", name: "Mike", country: "USA", color: "bg-blue-600", gradient: "from-blue-600 to-blue-900", images: { default: "https://i.imgur.com/7SmjYqQ.png", positive: "https://i.imgur.com/7SmjYqQ.png", negative: "https://i.imgur.com/7SmjYqQ.png" } },
        { id: "china", name: "Wei", country: "CHINA", color: "bg-emerald-600", gradient: "from-emerald-600 to-emerald-900", images: { default: "https://i.imgur.com/8Q0wX7t.png", positive: "https://i.imgur.com/YUIayKK.png", negative: "https://i.imgur.com/YUIayKK.png" } },
        { id: "korea", name: "Minji", country: "KOREA", color: "bg-pink-600", gradient: "from-pink-600 to-purple-900", images: { default: "https://i.imgur.com/q6CtsFv.png", positive: "https://i.imgur.com/q6CtsFv.png", negative: "https://i.imgur.com/q6CtsFv.png" } },
        { id: "brazil", name: "Camila", country: "BRAZIL", color: "bg-orange-600", gradient: "from-orange-600 to-red-900", images: { default: "https://i.imgur.com/siSE3Lo.png", positive: "https://i.imgur.com/siSE3Lo.png", negative: "https://i.imgur.com/GG1EHzs.png" } },
        { id: "uk", name: "Olivia", country: "UK", color: "bg-red-600", gradient: "from-red-600 to-red-900", images: { default: "https://i.imgur.com/utD04N9.png", positive: "https://i.imgur.com/utD04N9.png", negative: "https://i.imgur.com/NmcKRbG.png" } },
        { id: "greece", name: "Nikos", country: "GREECE", color: "bg-cyan-600", gradient: "from-cyan-600 to-blue-800", images: { default: "https://i.imgur.com/YOkJPH5.png", positive: "https://i.imgur.com/YOkJPH5.png", negative: "https://i.imgur.com/E9tL3YH.png" } },
        { id: "vietnam", name: "Linh", country: "VIETNAM", color: "bg-teal-600", gradient: "from-teal-600 to-emerald-900", images: { default: "https://i.imgur.com/LDaDwya.png", positive: "https://i.imgur.com/LDaDwya.png", negative: "https://i.imgur.com/Qmmn3lx.png" } },
        { id: "australia", name: "Liam", country: "AUSTRALIA", color: "bg-yellow-600", gradient: "from-yellow-600 to-orange-900", images: { default: "https://i.imgur.com/li2sV02.png", positive: "https://i.imgur.com/li2sV02.png", negative: "https://i.imgur.com/iMAQNKm.png" } }
      ];

      const GESTURES = [
        { id: "thumbs_up", label: "엄지 척", icon: "https://i.imgur.com/uGRSLpc.png", relatedCharacters: ["usa", "korea", "iran", "australia"], culturalNote: [{ characterId: "iran", note: "장난해?\n이거 엄청 심한 욕이야!", isNegative: true }, { characterId: "australia", note: "어이,\n그거 무례한 짓이야.", isNegative: true }, { characterId: "usa", note: "오,\n완전 좋아!" }, { characterId: "korea", note: "대박!\n최고야!" }] },
        { id: "v_sign", label: "브이", icon: "https://i.imgur.com/Atdb3nG.png", relatedCharacters: ["korea", "usa", "uk", "australia"], culturalNote: [{ characterId: "uk", note: "싸우자는 거야?\n당장 집어치워.", isNegative: true }, { characterId: "korea", note: "하나 둘 셋,\n김치~" }, { characterId: "usa", note: "평화!\n피스~" }] },
        { id: "ok_sign", label: "OK 사인", icon: "https://i.imgur.com/j0xZ5AP.png", relatedCharacters: ["usa", "france", "brazil", "korea"], culturalNote: [{ characterId: "brazil", note: "미쳤어?\n그거 뻐큐랑 같은 뜻이야!", isNegative: true }, { characterId: "france", note: "음...\n형편없네. 빵점이야.", isNegative: true }, { characterId: "usa", note: "오케이!\n딱 좋아." }] },
        { id: "call_me", label: "전화해", icon: "https://i.imgur.com/CTbRPTO.png", relatedCharacters: ["usa", "china", "korea", "brazil"], culturalNote: [{ characterId: "china", note: "이거 숫자\n6인 거 알지?" }, { characterId: "usa", note: "나중에\n전화해!" }] },
        { id: "crossed_fingers", label: "행운을 빌어", icon: "https://i.imgur.com/6iSs6LM.png", relatedCharacters: ["usa", "vietnam", "uk", "france"], culturalNote: [{ characterId: "vietnam", note: "야! 그거 진짜\n저질스러운 욕이야.", isNegative: true }, { characterId: "usa", note: "행운을 빌게!\n잘 될 거야." }] },
        { id: "stop_palm", label: "멈춰", icon: "https://i.imgur.com/eme6I4i.png", relatedCharacters: ["usa", "greece", "iran", "japan"], culturalNote: [{ characterId: "greece", note: "지금 내 얼굴에 뭐 뿌리냐?\n최악의 모욕이야!", isNegative: true }, { characterId: "iran", note: "그만해,\n무례하네.", isNegative: true }, { characterId: "japan", note: "잠깐!\n거기 서.", isNegative: true, image: "https://i.imgur.com/ygbmB4I.png" }, { characterId: "usa", note: "잠깐,\n거기 멈춰." }] },
        { id: "two_hands", label: "두 손 모아", icon: "https://i.imgur.com/XLesUSL.png", relatedCharacters: ["korea", "japan", "usa", "france"], culturalNote: [{ characterId: "korea", note: "안녕하세요,\n존경합니다." }, { characterId: "japan", note: "제발!\n부탁드려요." }, { characterId: "usa", note: "돈 달라는 거야?\n왜 그래?", image: "https://i.imgur.com/7GJhlqS.png" }] },
        { id: "rock_on", label: "락앤롤", icon: "https://i.imgur.com/eMVh3F9.png", relatedCharacters: ["usa", "brazil", "uk", "korea"], culturalNote: [{ characterId: "brazil", note: "조심해,\n네 애인 바람피우고 있어...", isNegative: true }, { characterId: "usa", note: "예아!\n락앤롤!" }] }
      ];

      const DEFAULT_CHARACTERS = ["france", "iran", "japan", "usa"];

      // --- 컴포넌트 ---

      function TitleScreen({ onStart }) {
        return (
          <div className="relative w-full h-full bg-[#111] overflow-hidden">
            <div className="absolute inset-0 z-0">
              <img src="https://i.imgur.com/onD1MMs.png" alt="Title" className="w-full h-full object-cover" />
            </div>
            <div className="relative z-10 w-full h-full flex flex-col items-center justify-end pb-24">
              <button onClick={onStart} className="px-16 py-6 bg-black/40 backdrop-blur-xl border border-white/20 text-white font-black text-3xl tracking-widest rounded-full transition-all hover:scale-105 hover:bg-white/10">
                START
              </button>
            </div>
          </div>
        );
      }

      function EncyclopediaScreen({ onBack }) {
        return (
          <div className="w-full h-full bg-neutral-950 text-white overflow-hidden flex flex-col">
            <div className="flex items-center justify-between px-6 py-4 bg-neutral-900/50 border-b border-white/10 h-16 z-10">
              <button onClick={onBack} className="text-white/60 hover:text-white flex items-center gap-2 group">
                <span className="text-xl group-hover:-translate-x-1">←</span>
                <span className="font-bold text-xs uppercase">BACK</span>
              </button>
              <h2 className="text-lg font-black uppercase">제스처 도감</h2>
              <div className="w-12"></div>
            </div>
            <div className="flex-1 p-4 overflow-y-auto no-scrollbar">
              <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                {GESTURES.map(gesture => (
                  <div key={gesture.id} className="bg-neutral-900/40 border border-white/5 rounded-xl p-3 flex flex-col">
                    <div className="flex items-center justify-center mb-2">
                      <div className="bg-white/10 p-2 rounded-xl">
                        <img src={gesture.icon} className="w-8 h-8 object-contain" />
                      </div>
                    </div>
                    <div className="space-y-2">
                      {gesture.culturalNote.map((note, idx) => {
                        const char = CHARACTERS.find(c => c.id === note.characterId);
                        return char ? (
                          <div key={idx} className={`p-2 rounded-lg ${note.isNegative ? 'bg-red-500/10' : 'bg-white/5'}`}>
                            <span className="text-[10px] font-black text-indigo-300 block">{char.country}</span>
                            <p className="text-[11px] opacity-80">{note.note.replace(/\n/g, ' ')}</p>
                          </div>
                        ) : null;
                      })}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        );
      }

      function SimulationScreen({ onBack, onOpenDictionary }) {
        const [clickedGestureId, setClickedGestureId] = useState(null);
        const [hoveredGestureId, setHoveredGestureId] = useState(null);

        const viewingGestureId = hoveredGestureId || clickedGestureId;
        const viewingGesture = GESTURES.find((g) => g.id === viewingGestureId);
        const isReacting = !!clickedGestureId && (viewingGestureId === clickedGestureId);

        const targetIds = viewingGesture?.relatedCharacters || DEFAULT_CHARACTERS;
        const displayCharacters = useMemo(() => {
          const primary = targetIds.map(id => CHARACTERS.find(c => c.id === id)).filter(Boolean);
          const others = CHARACTERS.filter(c => !primary.find(p => p.id === c.id));
          return [...primary, ...others].slice(0, 4);
        }, [targetIds]);

        return (
          <div className="relative w-full h-[100dvh] bg-black text-white overflow-hidden flex flex-col md:flex-row">
            <button onClick={onBack} className="fixed top-4 left-4 z-50 bg-black/40 p-3 rounded-full border border-white/10 hover:bg-white hover:text-black transition-all">
              <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2.5"/></svg>
            </button>
            <button onClick={onOpenDictionary} className="fixed top-4 right-4 z-50 bg-black/40 p-3 rounded-full border border-white/10 hover:bg-white hover:text-black transition-all">
              <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" strokeLinecap="round" strokeLinejoin="round" strokeWidth="2"/></svg>
            </button>

            {displayCharacters.map((char) => {
              const note = viewingGesture?.culturalNote?.find(n => n.characterId === char.id);
              const isNegative = note?.isNegative;
              const imgSrc = isReacting ? (note?.image || (isNegative ? char.images.negative : char.images.positive)) : char.images.default;
              const bubbleText = isReacting ? (note?.note || viewingGesture?.label) : "";

              return (
                <div key={char.id} className="relative h-full border-white/20 flex-1 group overflow-hidden">
                  <div className={`absolute inset-0 bg-gradient-to-b ${char.gradient} opacity-80 group-hover:opacity-100 transition-opacity`} />
                  <img src={imgSrc} className={`w-full h-full object-cover ${isReacting ? "animate-float" : ""}`} />
                  <div className="absolute inset-x-0 bottom-0 h-2/3 bg-gradient-to-t from-black/90 to-transparent pointer-events-none" />
                  
                  {isReacting && (
                    <div className="absolute top-[75%] left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full px-4 flex justify-center z-10">
                      <div className={`px-4 py-2 rounded-xl border-2 ${isNegative ? "bg-red-600/90 border-red-400 text-white" : "bg-white/90 border-white text-black"} shadow-2xl`}>
                        <p className="text-sm md:text-lg font-bold whitespace-pre-wrap">"{bubbleText}"</p>
                      </div>
                    </div>
                  )}
                  <div className="absolute top-8 right-8 text-right hidden md:block">
                    <span className="block text-5xl font-black opacity-80 uppercase">{char.country}</span>
                  </div>
                </div>
              );
            })}

            <div className="fixed bottom-0 left-0 w-full pb-8 pt-6 px-4 z-50 flex justify-center items-end bg-gradient-to-t from-black via-black/80 to-transparent pointer-events-none">
              <div className="pointer-events-auto bg-neutral-900/60 backdrop-blur-xl border border-white/10 rounded-[2rem] p-2 flex gap-2 overflow-x-auto no-scrollbar">
                {GESTURES.map(g => (
                  <button key={g.id} onClick={() => setClickedGestureId(clickedGestureId === g.id ? null : g.id)} onMouseEnter={() => setHoveredGestureId(g.id)} onMouseLeave={() => setHoveredGestureId(null)} className={`w-14 h-14 md:w-16 md:h-16 rounded-2xl flex items-center justify-center border-2 transition-all ${(clickedGestureId === g.id || hoveredGestureId === g.id) ? 'bg-white border-white scale-110' : 'bg-transparent border-transparent hover:bg-white/10'}`}>
                    <img src={g.icon} className="w-8 h-8 md:w-10 md:h-10 object-contain" />
                  </button>
                ))}
              </div>
            </div>
          </div>
        );
      }

      function App() {
        const [screen, setScreen] = useState('TITLE');
        const [prevScreen, setPrevScreen] = useState('TITLE');
        return (
          <React.Fragment>
            {screen === 'TITLE' && <TitleScreen onStart={() => setScreen('SIM')} />}
            {screen === 'SIM' && <SimulationScreen onBack={() => setScreen('TITLE')} onOpenDictionary={() => { setPrevScreen('SIM'); setScreen('DICT'); }} />}
            {screen === 'DICT' && <EncyclopediaScreen onBack={() => setScreen(prevScreen)} />}
          </React.Fragment>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>