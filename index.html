<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>ÎÑà Î∞©Í∏à Î≠êÎùºÍ∑∏Îû¨Ïñ¥?</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
    
    <!-- React & ReactDOM (UMD Build) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; font-family: 'Noto Sans KR', 'Inter', sans-serif; overflow: hidden; }
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      /* Cross-fade transition helper */
      .fade-enter { opacity: 0; }
      .fade-enter-active { opacity: 1; transition: opacity 500ms ease-in; }
      .fade-exit { opacity: 1; }
      .fade-exit-active { opacity: 0; transition: opacity 500ms ease-in; }
      
      /* Scrollbar for Encyclopedia */
      .custom-scrollbar::-webkit-scrollbar { width: 8px; }
      .custom-scrollbar::-webkit-scrollbar-track { background: #1a1a1a; }
      .custom-scrollbar::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #666; }

      /* Noise Texture for Intro */
      .bg-noise {
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0"
  }
}
</script>
</head>
  <body>
    <div id="root" style="height: 100%;"></div>

    <!-- Main Application Script -->
    <script type="text/babel">
      const { useState, useEffect, useMemo, useCallback, memo, Component } = React;
      const { createRoot } = ReactDOM;

      // --- 0. ERROR BOUNDARY ---
      class ErrorBoundary extends Component {
        constructor(props) {
          super(props);
          this.state = { hasError: false, error: null };
        }
        static getDerivedStateFromError(error) {
          return { hasError: true, error };
        }
        componentDidCatch(error, errorInfo) {
          console.error("Uncaught error:", error, errorInfo);
        }
        render() {
          if (this.state.hasError) {
            return (
              <div className="h-full w-full flex flex-col items-center justify-center bg-zinc-900 text-white p-8 text-center">
                 <h1 className="text-2xl font-bold mb-2">Something went wrong</h1>
                 <button onClick={() => window.location.reload()} className="px-4 py-2 bg-white text-black rounded font-bold hover:bg-gray-200">
                    Reload App
                 </button>
              </div>
            );
          }
          return this.props.children;
        }
      }

      // --- 1. CONSTANTS & DATA (With Dynamic Images) ---

      // Image mapping: default (neutral), positive (happy), negative (angry/shocked)
      const CHARACTERS = [
        { 
          id: 'france', 
          name: "Am√©lie", 
          country: "France", 
          textColor: "text-indigo-100", 
          bgColor: "bg-indigo-900",
          images: {
            default: "https://i.imgur.com/RiwM0bn.png",
            positive: "https://i.imgur.com/RiwM0bn.png",
            negative: "https://i.imgur.com/RiwM0bn.png"
          }
        },
        { 
          id: 'iran', 
          name: "Reza", 
          country: "Iran", 
          textColor: "text-stone-100", 
          bgColor: "bg-stone-800",
          images: {
            default: "https://i.imgur.com/EBhBLHm.png",
            positive: "https://i.imgur.com/EBhBLHm.png",
            negative: "https://i.imgur.com/EBhBLHm.png"
          }
        },
        { 
          id: 'japan', 
          name: "Sakura", 
          country: "Japan", 
          textColor: "text-rose-100", 
          bgColor: "bg-rose-900",
          images: {
            default: "https://i.imgur.com/C86aaHA.png",
            positive: "https://i.imgur.com/C86aaHA.png",
            negative: "https://i.imgur.com/C86aaHA.png"
          }
        },
        { 
          id: 'usa', 
          name: "Mike", 
          country: "USA", 
          textColor: "text-blue-100", 
          bgColor: "bg-blue-900", // Blue theme
          images: {
            default: "https://i.imgur.com/RurQa2e.png",
            positive: "https://i.imgur.com/RurQa2e.png",
            negative: "https://i.imgur.com/RurQa2e.png"
          }
        },
        { 
          id: 'china', 
          name: "Wei", 
          country: "China", 
          textColor: "text-red-100", 
          bgColor: "bg-emerald-900", // Greenish theme
          images: {
            default: "https://i.imgur.com/kfcVH3j.png",
            positive: "https://i.imgur.com/kfcVH3j.png",
            negative: "https://i.imgur.com/kfcVH3j.png"
          }
        },
        { 
          id: 'korea', 
          name: "Minji", 
          country: "Korea", 
          textColor: "text-purple-100", 
          bgColor: "bg-pink-900", // Pinkish theme
          images: {
            default: "https://i.imgur.com/q23utbl.png",
            positive: "https://i.imgur.com/q23utbl.png",
            negative: "https://i.imgur.com/q23utbl.png"
          }
        },
        { 
          id: 'brazil', 
          name: "Lucas", 
          country: "Brazil", 
          textColor: "text-yellow-100", 
          bgColor: "bg-orange-900", // Orange theme
          images: {
            default: "https://i.imgur.com/siSE3Lo.png",
            positive: "https://i.imgur.com/siSE3Lo.png",
            negative: "https://i.imgur.com/siSE3Lo.png"
          }
        },
        { 
          id: 'uk', 
          name: "Arthur", 
          country: "UK", 
          textColor: "text-red-100", 
          bgColor: "bg-red-900",
          images: {
            default: "https://api.dicebear.com/7.x/micah/svg?seed=Arthur&backgroundColor=991b1b&mouth=smile",
            positive: "https://api.dicebear.com/7.x/micah/svg?seed=Arthur&backgroundColor=991b1b&mouth=laughing",
            negative: "https://api.dicebear.com/7.x/micah/svg?seed=Arthur&backgroundColor=991b1b&mouth=pucker&eyebrows=down"
          }
        },
        { 
          id: 'greece', 
          name: "Nikos", 
          country: "Greece", 
          textColor: "text-cyan-100", 
          bgColor: "bg-cyan-900",
          images: {
            default: "https://api.dicebear.com/7.x/micah/svg?seed=Nikos&backgroundColor=155e75&mouth=smile",
            positive: "https://api.dicebear.com/7.x/micah/svg?seed=Nikos&backgroundColor=155e75&mouth=laughing",
            negative: "https://api.dicebear.com/7.x/micah/svg?seed=Nikos&backgroundColor=155e75&mouth=pucker&eyebrows=down"
          }
        },
        { 
          id: 'vietnam', 
          name: "Linh", 
          country: "Vietnam", 
          textColor: "text-emerald-100", 
          bgColor: "bg-emerald-900",
          images: {
            default: "https://api.dicebear.com/7.x/micah/svg?seed=Linh&backgroundColor=065f46&mouth=smile",
            positive: "https://api.dicebear.com/7.x/micah/svg?seed=Linh&backgroundColor=065f46&mouth=laughing",
            negative: "https://api.dicebear.com/7.x/micah/svg?seed=Linh&backgroundColor=065f46&mouth=pucker&eyebrows=down"
          }
        },
        { 
          id: 'australia', 
          name: "Liam", 
          country: "Australia", 
          textColor: "text-orange-100", 
          bgColor: "bg-orange-800",
          images: {
            default: "https://api.dicebear.com/7.x/micah/svg?seed=Liam&backgroundColor=9a3412&mouth=smile",
            positive: "https://api.dicebear.com/7.x/micah/svg?seed=Liam&backgroundColor=9a3412&mouth=laughing",
            negative: "https://api.dicebear.com/7.x/micah/svg?seed=Liam&backgroundColor=9a3412&mouth=pucker&eyebrows=down"
          }
        }
      ];

      // Updated default order based on request: France, Iran, Japan, USA (as 4th)
      const DEFAULT_CHARACTERS = ['france', 'iran', 'japan', 'usa'];

      const GESTURES = [
        { id: "thumbs_up", label: "Thumbs Up", icon: "üëç", relatedCharacters: ['usa', 'korea', 'iran', 'australia'], culturalNote: [{ characterId: 'iran', note: "Offensive!", isNegative: true }, { characterId: 'australia', note: "Rude!", isNegative: true }, { characterId: 'usa', note: "Good!" }, { characterId: 'korea', note: "Good!" }] },
        { id: "v_sign", label: "V Sign", icon: "‚úåÔ∏è", relatedCharacters: ['korea', 'usa', 'uk', 'australia'], culturalNote: [{ characterId: 'uk', note: "Insult!", isNegative: true }, { characterId: 'korea', note: "Cute Pose" }, { characterId: 'usa', note: "Peace" }] },
        { id: "ok_sign", label: "OK Sign", icon: "üëå", relatedCharacters: ['usa', 'france', 'brazil', 'korea'], culturalNote: [{ characterId: 'brazil', note: "Extreme Insult!", isNegative: true }, { characterId: 'france', note: "Means Zero", isNegative: true }, { characterId: 'usa', note: "Perfect" }] },
        { id: "call_me", label: "Call Me", icon: "ü§ô", relatedCharacters: ['usa', 'china', 'korea', 'brazil'], culturalNote: [{ characterId: 'china', note: "Means 'Debt'!", isNegative: true }, { characterId: 'usa', note: "Call me" }] },
        { id: "crossed_fingers", label: "Good Luck", icon: "ü§û", relatedCharacters: ['usa', 'vietnam', 'uk', 'france'], culturalNote: [{ characterId: 'vietnam', note: "Sexual Insult!", isNegative: true }, { characterId: 'usa', note: "Good Luck" }] },
        { id: "stop_palm", label: "Stop", icon: "‚úã", relatedCharacters: ['usa', 'greece', 'iran', 'japan'], culturalNote: [{ characterId: 'greece', note: "Insult (Moutza)!", isNegative: true }, { characterId: 'iran', note: "Rude!", isNegative: true }, { characterId: 'usa', note: "Stop" }] },
        { id: "two_hands", label: "Two Hands", icon: "ü§≤", relatedCharacters: ['korea', 'japan', 'usa', 'france'], culturalNote: [{ characterId: 'korea', note: "Respect" }, { characterId: 'usa', note: "Too formal" }] },
        { id: "rock_on", label: "Rock On", icon: "ü§ò", relatedCharacters: ['usa', 'brazil', 'greece', 'uk'], culturalNote: [{ characterId: 'brazil', note: "Cuckold (Insult)!", isNegative: true }, { characterId: 'greece', note: "Cuckold (Insult)!", isNegative: true }, { characterId: 'usa', note: "Rock n Roll!" }] },
        { id: "come_here", label: "Come Here", icon: "‚òùÔ∏è", relatedCharacters: ['usa', 'korea', 'japan', 'uk'], culturalNote: [{ characterId: 'usa', note: "Come here" }, { characterId: 'korea', note: "Rude (Dog)!", isNegative: true }, { characterId: 'japan', note: "Rude/Thief!", isNegative: true }] }
      ];

      // --- 2. LOGIC ---
      
      const fetchReactions = async (gesture, activeCharacters) => {
        if (!gesture || !activeCharacters) return [];
        // Short delay to simulate processing
        await new Promise(resolve => setTimeout(resolve, 200));

        return activeCharacters.map(char => {
          const noteData = gesture.culturalNote ? gesture.culturalNote.find(n => n.characterId === char.id) : null;
          let dialogue = "", actionDescription = "", emotion = "default";

          if (noteData) {
            dialogue = `${noteData.note}`; 
            if (noteData.isNegative) {
                emotion = "negative";
                actionDescription = "Angry / Shocked";
            } else {
                emotion = "positive";
                actionDescription = "Smiling happily";
            }
          } else {
            dialogue = "I see!";
            emotion = "default";
            actionDescription = "Neutral";
          }

          return { characterId: char.id, dialogue, actionDescription, emotion };
        });
      };

      // --- 3. COMPONENTS ---

      const GestureEncyclopedia = ({ onClose }) => {
        return (
          <div className="fixed inset-0 z-[60] bg-black/95 backdrop-blur-xl overflow-y-auto custom-scrollbar p-4 lg:p-10 animate-[fadeIn_0.3s_ease-out]">
              <button 
                  onClick={onClose} 
                  className="fixed top-24 right-6 z-50 text-white bg-white/10 hover:bg-white/20 hover:scale-110 border border-white/20 rounded-full p-3 transition-all duration-300"
              >
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-6 h-6">
                    <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
                  </svg>
              </button>
              
              <div className="text-center mt-10 mb-12">
                  <h2 className="text-4xl lg:text-5xl font-black text-white mb-2 uppercase tracking-tighter">Gesture Encyclopedia</h2>
                  <p className="text-gray-400 uppercase tracking-[0.3em] text-xs lg:text-sm">Global Meanings Guide</p>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 max-w-7xl mx-auto pb-20">
                  {GESTURES.map(gesture => (
                      <div key={gesture.id} className="bg-zinc-900/50 border border-white/10 rounded-2xl p-6 hover:bg-zinc-800/50 transition-all duration-300 hover:border-white/20 group">
                          <div className="flex items-center gap-4 mb-6 border-b border-white/10 pb-4">
                              <span className="text-5xl group-hover:scale-110 transition-transform duration-300">{gesture.icon}</span>
                              <h3 className="text-xl font-bold text-white uppercase tracking-tight">{gesture.label}</h3>
                          </div>
                          
                          <div className="space-y-3">
                              {gesture.culturalNote?.map((note, idx) => {
                                   const char = CHARACTERS.find(c => c.id === note.characterId);
                                   if (!char) return null;
                                   return (
                                       <div key={idx} className="flex justify-between items-start text-sm">
                                           <div className="flex items-center gap-2">
                                              <span className={`w-2 h-2 rounded-full ${note.isNegative ? 'bg-red-500' : 'bg-green-500'}`}></span>
                                              <span className="text-gray-400 font-medium shrink-0">{char.country}</span>
                                           </div>
                                           <span className={`text-right font-bold ${note.isNegative ? 'text-red-400' : 'text-emerald-400'}`}>
                                              {note.note}
                                           </span>
                                       </div>
                                   )
                              })}
                              {(!gesture.culturalNote || gesture.culturalNote.length === 0) && (
                                <p className="text-gray-600 text-sm italic">Universal meaning in standard contexts.</p>
                              )}
                          </div>
                      </div>
                  ))}
              </div>
          </div>
        )
      };

      const CharacterStrip = memo(({ profile, reaction, isLoading }) => {
        const [imgError, setImgError] = useState(false);

        // Determine which image URL to show
        let currentImageUrl = profile?.images?.default;
        if (reaction && !isLoading) {
            if (reaction.emotion === 'positive') currentImageUrl = profile?.images?.positive;
            if (reaction.emotion === 'negative') currentImageUrl = profile?.images?.negative;
        }

        // Reset error state if profile changes
        useEffect(() => {
            setImgError(false);
        }, [profile?.id, currentImageUrl]);

        if (!profile) return <div className="bg-zinc-900 w-full h-full" />;

        return (
          <div className={`relative h-full w-full overflow-hidden border-r border-white/10 last:border-r-0 ${profile.bgColor}`}>
            {/* Dynamic Image Layer */}
            <div className="absolute inset-0 w-full h-full transition-opacity duration-700">
               {!imgError && currentImageUrl ? (
                   // We key by URL so React knows to cross-fade between different image sources
                   <img 
                     key={currentImageUrl}
                     src={currentImageUrl} 
                     alt={profile.name} 
                     onError={() => setImgError(true)}
                     className={`w-full h-full object-cover animate-[fadeIn_0.5s_ease-out] ${isLoading ? 'blur-sm scale-105 grayscale-[30%]' : 'blur-0 scale-100'}`}
                     style={{ transition: 'filter 0.5s ease, transform 0.5s ease' }}
                   />
               ) : (
                  <div className={`w-full h-full ${profile.bgColor} flex items-center justify-center opacity-50`}>
                     <span className="text-white font-bold">{profile.country}</span>
                  </div>
               )}
               {/* Gradient Overlay for Text Readability */}
               <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-black/10"></div>
            </div>

            {/* Country Watermark */}
            <div className="absolute top-4 left-4 z-10 pointer-events-none">
              <h2 className="text-4xl lg:text-6xl font-black uppercase tracking-tighter text-white/10 select-none">
                {profile.country}
              </h2>
            </div>

            {/* Name Tag */}
            <div className="absolute top-8 right-8 z-10 pointer-events-none text-right">
              <p className="text-xs font-bold text-white/80 uppercase tracking-[0.2em] border-b border-white/30 pb-1 mb-1">
                {profile.name}
              </p>
              <p className="text-[10px] text-white/50 uppercase">
                {profile.country}
              </p>
            </div>

            {/* Reaction Bubble (Only shows on Click/Reaction) */}
            <div className={`absolute bottom-[25%] left-1/2 -translate-x-1/2 z-20 w-11/12 max-w-[280px] transition-all duration-500 ease-out transform ${reaction && !isLoading ? 'opacity-100 translate-y-0 scale-100' : 'opacity-0 translate-y-8 scale-90 pointer-events-none'}`}>
              <div className="bg-white/95 backdrop-blur-md p-5 rounded-xl shadow-2xl border border-white/50 text-center relative">
                <div className="absolute -bottom-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white/95 rotate-45 border-r border-b border-white/50"></div>
                <p className="text-lg font-bold text-gray-900 mb-1 leading-tight">"{reaction?.dialogue}"</p>
                <p className="text-[10px] text-gray-500 font-medium uppercase tracking-wider border-t border-gray-200 pt-2 mt-2">{reaction?.actionDescription}</p>
              </div>
            </div>

             {/* Loading Indicator */}
            {isLoading && (
              <div className="absolute bottom-1/2 left-1/2 -translate-x-1/2 translate-y-1/2 z-20 flex gap-2">
                 <div className="w-2 h-2 rounded-full bg-white animate-bounce"></div>
                 <div className="w-2 h-2 rounded-full bg-white animate-bounce delay-75"></div>
                 <div className="w-2 h-2 rounded-full bg-white animate-bounce delay-150"></div>
              </div>
            )}
          </div>
        );
      });

      const GestureControl = memo(({ onSelectGesture, onHoverGesture, isLoading, selectedGestureId }) => {
        return (
          <div className="fixed bottom-6 left-1/2 -translate-x-1/2 z-50 w-full max-w-3xl px-4">
            <div className="bg-black/60 backdrop-blur-2xl rounded-full p-2 shadow-2xl border border-white/10 flex items-center justify-between gap-2 overflow-x-auto no-scrollbar ring-1 ring-white/20">
              {GESTURES.map((gesture) => (
                <button
                  key={gesture.id}
                  onClick={() => onSelectGesture(gesture)}
                  onMouseEnter={() => onHoverGesture(gesture)}
                  onMouseLeave={() => onHoverGesture(null)}
                  disabled={isLoading}
                  className={`
                    relative group flex flex-col items-center justify-center 
                    min-w-[80px] h-[80px] rounded-full transition-all duration-300 flex-shrink-0
                    ${selectedGestureId === gesture.id ? 'bg-white text-black scale-105 shadow-[0_0_20px_rgba(255,255,255,0.3)]' : 'bg-white/5 text-white hover:bg-white/10'}
                    ${isLoading ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}
                  `}
                >
                  <span className="text-3xl transition-transform duration-300 group-hover:scale-110">{gesture.icon}</span>
                  {/* Label Removed */}
                </button>
              ))}
            </div>
            <div className="text-center mt-3">
               <p className="text-white/40 text-[10px] font-medium uppercase tracking-[0.2em] animate-pulse">
                {isLoading ? "Analyzing..." : "Hover to Preview ‚Ä¢ Click to Interact"}
              </p>
            </div>
          </div>
        );
      });

      // --- 4. APP ---

      const App = () => {
        const [started, setStarted] = useState(false); // Controls intro screen
        const [showGuide, setShowGuide] = useState(false); // Controls Encyclopedia
        const [currentReactions, setCurrentReactions] = useState([]);
        const [loading, setLoading] = useState(false);
        const [selectedGestureId, setSelectedGestureId] = useState(null);
        const [hoveredGestureId, setHoveredGestureId] = useState(null);

        // 1. Calculate Active Characters
        const activeCharacters = useMemo(() => {
          // Priority: Hovered > Selected > Default
          let targetId = hoveredGestureId || selectedGestureId;
          let ids = DEFAULT_CHARACTERS;

          if (targetId) {
             const g = GESTURES.find(g => g.id === targetId);
             if (g && g.relatedCharacters) ids = g.relatedCharacters;
          }

          // Convert IDs to Objects
          const chars = ids.map(id => CHARACTERS.find(c => c.id === id)).filter(Boolean);
          return chars.length > 0 ? chars : CHARACTERS.slice(0, 4);
        }, [hoveredGestureId, selectedGestureId]);

        // 2. Click Handler (Update Reactions & Images)
        const handleGestureSelect = useCallback(async (gesture) => {
          if (loading || !gesture) return;
          
          setHoveredGestureId(null); // Clear hover to lock selection
          setLoading(true);
          setSelectedGestureId(gesture.id);
          setCurrentReactions([]); // Clear previous

          try {
            // Find characters relevant to this gesture
            const nextCharacterIds = gesture.relatedCharacters || DEFAULT_CHARACTERS;
            const nextCharacters = nextCharacterIds.map(id => CHARACTERS.find(c => c.id === id)).filter(Boolean);
            
            // Get reactions (includes 'emotion' field now)
            const reactions = await fetchReactions(gesture, nextCharacters);
            setCurrentReactions(reactions);
          } catch (err) {
            console.error(err);
          } finally {
            setLoading(false);
          }
        }, [loading]);

        // 3. Hover Handler (Preview Only)
        const handleHoverGesture = useCallback((gesture) => {
          if (!loading) {
            setHoveredGestureId(gesture?.id || null);
            // If hovering, clear reactions so bubbles disappear (Clean Preview Mode)
            if (gesture) setCurrentReactions([]);
          }
        }, [loading]);

        const getReaction = useCallback((charId) => {
          return currentReactions.find(r => r.characterId === charId) || null;
        }, [currentReactions]);

        return (
          <div className="relative w-full h-[100dvh] bg-black overflow-hidden font-sans">
             {/* INTRO SCREEN */}
             <div 
               onClick={() => setStarted(true)}
               className={`fixed inset-0 z-[100] bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-zinc-900 via-black to-black bg-noise flex flex-col items-center justify-center cursor-pointer transition-opacity duration-1000 ${started ? 'opacity-0 pointer-events-none' : 'opacity-100'}`}
             >
                <div className="relative z-10 text-center px-4">
                    <h1 className="text-5xl lg:text-9xl font-black text-white tracking-tighter mb-8 leading-none">
                        ÎÑà Î∞©Í∏à<br className="lg:hidden"/> 
                        <span className="text-rose-600 drop-shadow-[0_0_15px_rgba(225,29,72,0.6)] animate-pulse inline-block mt-2 lg:mt-0">Î≠êÎùºÍ∑∏Îû¨Ïñ¥?</span>
                    </h1>
                    {/* Subtitle Removed */}
                    
                    <div className="mt-20 flex justify-center">
                        <span className="text-white/60 text-xs lg:text-sm border border-white/20 px-8 py-4 rounded-full hover:bg-white/10 transition-all hover:scale-105 hover:border-white/50 tracking-widest uppercase">
                            Click to Enter
                        </span>
                    </div>
                </div>
             </div>

             {/* ENCYCLOPEDIA BUTTON (Moved down to top-32) */}
             {started && (
                <button 
                    onClick={() => setShowGuide(true)}
                    className="fixed top-32 right-6 z-50 bg-white/10 hover:bg-white/20 backdrop-blur-md text-white p-3 rounded-full border border-white/10 transition-all duration-300 hover:scale-110 group"
                    title="Gesture Encyclopedia"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5 lg:w-6 lg:h-6">
                      <path strokeLinecap="round" strokeLinejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
                    </svg>
                    <span className="absolute right-full mr-3 top-1/2 -translate-y-1/2 bg-white text-black text-[10px] font-bold px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none">
                        ENCYCLOPEDIA
                    </span>
                </button>
             )}

             {/* ENCYCLOPEDIA MODAL */}
             {showGuide && <GestureEncyclopedia onClose={() => setShowGuide(false)} />}

             {/* MAIN CONTENT (Fades in) */}
             <div className={`w-full h-full flex flex-col lg:flex-row transition-opacity duration-1000 ${started ? 'opacity-100' : 'opacity-0'}`}>
                {activeCharacters.map((char) => (
                   <div key={char.id} className="flex-1 relative border-b lg:border-b-0 lg:border-r border-white/10 last:border-0 overflow-hidden">
                      <CharacterStrip 
                        profile={char} 
                        reaction={getReaction(char.id)} 
                        isLoading={loading} 
                      />
                   </div>
                ))}
                
                <GestureControl 
                   onSelectGesture={handleGestureSelect} 
                   onHoverGesture={handleHoverGesture} 
                   isLoading={loading} 
                   selectedGestureId={selectedGestureId} 
                 />
             </div>
          </div>
        );
      };

      const root = createRoot(document.getElementById("root"));
      root.render(
        <ErrorBoundary>
          <App />
        </ErrorBoundary>
      );
    </script>
    <style>
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
  </body>
</html>